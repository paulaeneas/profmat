from django.shortcuts import get_object_or_404, render
from .models import Region, Substation, Transformer
import datetime
import json


def index(request):
    """Main"""
    region_list = Region.objects.order_by('name')
    context = {'region_list': region_list}

    return render(request, 'TRLife/home.html', context)


def detail_substation(request, se_short_name):
    """Retorna 404 ou carrega os dados do primeiro transformador da subestação"""
    substation = get_object_or_404(Substation, short_name=se_short_name)
    transformers = substation.transformer_set.all()
    transformer = transformers[0]
    return detail_transformer(request, se_short_name, transformer.name)


def detail_transformer(request, se_short_name, tr_name):
    """Carrega os dados do transformador"""
    substation = Substation.objects.get(short_name=se_short_name)
    tr_path_name = se_short_name+"_"+tr_name
    transformer = Transformer.objects.get(path_name=tr_path_name)

    # Data
    life_days, data_json = data_transformer(transformer)
    context = {'substation': substation, 'transformer': transformer, 'life_days': life_days, 'data_json': data_json}
    return render(request, 'TRLife/detail_substation.html', context)


def data_transformer(transformer):

    #Dados dos transformadores
    if transformer.path_name == 'ATI01_TR-01':
        x_arr = ['2008-12', '2009- 1', '2009- 2', '2009- 3', '2009- 4', '2009- 5', '2009- 6', '2009- 7', '2009- 8',
                 '2009- 9', '2009-10', '2009-11', '2009-12', '2010- 1', '2010- 2', '2010- 3', '2010- 4', '2010- 5',
                 '2010- 6', '2010- 7', '2010- 8', '2010- 9', '2010-10', '2010-11', '2010-12', '2011- 1', '2011- 2',
                 '2011- 3', '2011- 4', '2011- 5', '2011- 6', '2011- 7', '2011- 8', '2011- 9', '2011-10', '2011-11',
                 '2011-12', '2012- 1', '2012- 2', '2012- 3', '2012- 4', '2012- 5', '2012- 6', '2012- 7', '2012- 8',
                 '2012- 9', '2012-10', '2012-11', '2012-12', '2013- 1', '2013- 2', '2013- 3', '2013- 4', '2013- 5',
                 '2013- 6', '2013- 7', '2013- 8', '2013- 9', '2013-10', '2013-11', '2013-12', '2014- 1', '2014- 2',
                 '2014- 3', '2014- 4', '2014- 5', '2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11',
                 '2014-12', '2015- 1', '2015- 2', '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8',
                 '2015- 9', '2015-10', '2015-11', '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5',
                 '2016- 6', '2016- 7', '2016- 8', '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2',
                 '2017- 3', '2017- 4', '2017- 5', '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11',
                 '2017-12', '2018- 1', '2018- 2', '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8',
                 '2018- 9', '2018-10', '2018-11']
        ieee_arr = [2.29, 2.13, 1.76, 2.96, 2.54, 1.88, 1.59, 1.75, 2.35, 3.28, 1.96, 2.97, 2.66, 2.37, 2.33, 2.13, 2.2,
                    1.79, 2.09, 2.43, 2.27, 1.98, 2.37, 1.63, 2.62, 2.03, 2.55, 2.23, 2.35, 2.63, 2.24, 2.32, 2.24,
                    2.36, 2.69, 2.56, 2.19, 2.5, 2.16, 2.28, 2.53, 2.98, 2.34, 1.95, 2.13, 2.31, 2.59, 2.5, 2.73, 2.25,
                    2.14, 1.78, 1.99, 2.18, 2.3, 1.7, 2.2, 3.1, 2.3, 2.06, 2.84, 2.11, 2.6, 2.36, 2.56, 2.24, 2.48,
                    2.26, 1.85, 2.12, 2.59, 2.03, 1.97, 2.41, 2.3, 2.57, 2.36, 1.96, 1.93, 1.87, 2.49, 1.82, 2.19, 2.57,
                    2.2, 2.22, 2.81, 2.46, 1.89, 2.46, 2.0, 2.89, 2.2, 2.56, 2.15, 2.53, 2.6, 3.04, 2.2, 2.01, 2.22,
                    2.26, 2.39, 2.35, 2.65, 2.78, 2.13, 2.62, 2.6, 2.17, 2.41, 2.52, 2.5, 2.14, 2.11, 2.31, 1.52, 2.14,
                    2.61, 2.42]
        fuzzy_arr = [4.27, 3.47, 3.15, 4.2, 1.76, 1.18, 1.02, 1.09, 1.46, 1.95, 1.21, 1.79, 1.72, 1.52, 1.42, 1.31,
                     1.42, 1.15, 1.31, 1.47, 1.43, 1.25, 1.43, 1.06, 1.58, 1.24, 1.72, 1.36, 1.47, 1.56, 1.37, 1.5,
                     1.35, 1.43, 1.64, 1.59, 1.35, 1.54, 1.33, 1.41, 1.62, 1.77, 1.55, 1.24, 1.29, 1.5, 1.53, 1.52, 1.7,
                     1.43, 1.33, 1.13, 1.32, 1.38, 1.39, 1.07, 1.35, 1.83, 1.41, 1.28, 1.83, 1.48, 1.69, 1.55, 1.55,
                     1.4, 1.5, 1.38, 1.18, 1.29, 1.6, 1.27, 1.24, 1.46, 1.46, 1.54, 1.49, 1.24, 1.32, 1.16, 1.5, 1.14,
                     1.44, 1.58, 1.38, 1.38, 1.72, 1.49, 1.21, 1.49, 1.25, 1.77, 1.41, 1.53, 1.42, 1.54, 1.62, 1.82,
                     1.34, 1.26, 1.35, 1.39, 1.44, 1.42, 1.63, 1.72, 1.4, 1.6, 1.62, 1.35, 1.48, 1.53, 1.54, 1.3, 1.3,
                     1.43, 0.97, 1.34, 1.59, 1.57]
        carriel_arr = [2.01, 1.74, 1.4, 2.15, 1.77, 1.24, 1.01, 1.06, 1.36, 1.77, 1.08, 1.57, 1.39, 1.24, 1.21, 1.11,
                       1.16, 0.96, 1.1, 1.26, 1.18, 1.04, 1.23, 0.87, 1.35, 1.06, 1.34, 1.16, 1.22, 1.35, 1.17, 1.21,
                       1.16, 1.22, 1.39, 1.33, 1.15, 1.3, 1.13, 1.19, 1.32, 1.52, 1.23, 1.03, 1.11, 1.21, 1.33, 1.3,
                       1.41, 1.18, 1.12, 0.94, 1.06, 1.14, 1.19, 0.9, 1.15, 1.58, 1.2, 1.08, 1.48, 1.12, 1.36, 1.24,
                       1.33, 1.17, 1.28, 1.17, 0.98, 1.11, 1.34, 1.07, 1.04, 1.25, 1.2, 1.33, 1.23, 1.04, 1.03, 0.99,
                       1.29, 0.96, 1.15, 1.34, 1.15, 1.16, 1.46, 1.28, 1.0, 1.27, 1.05, 1.5, 1.15, 1.32, 1.14, 1.31,
                       1.36, 1.55, 1.14, 1.05, 1.15, 1.18, 1.24, 1.22, 1.37, 1.43, 1.12, 1.35, 1.35, 1.14, 1.24, 1.3,
                       1.3, 1.12, 1.1, 1.2, 0.81, 1.13, 1.34, 1.27]

        ieee_sum_pu = 8438.371618
        fuzzy_sum_pu = 5539.309085
        carriel_sum_pu = 4516.989110
        agua_mean = 0.296788
        oxigenio_mean = 12960.062979
        temp_mean = 104.740867
        start_excel_day = datetime.date(2008, 12, 1)
        end_excel_day = datetime.date(2018, 11, 30)

    elif transformer.path_name == 'ATI01_TR-02':

        x_arr = ['2012- 9', '2012-10', '2012-11', '2012-12', '2013- 1', '2013- 2', '2013- 3', '2013- 4', '2013- 5',
                 '2013- 6', '2013- 7', '2013- 8', '2013- 9', '2013-10', '2013-11', '2013-12', '2014- 1', '2014- 2',
                 '2014- 3', '2014- 4', '2014- 5', '2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11',
                 '2014-12', '2015- 1', '2015- 2', '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8',
                 '2015- 9', '2015-10', '2015-11', '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5',
                 '2016- 6', '2016- 7', '2016- 8', '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2',
                 '2017- 3', '2017- 4', '2017- 5', '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11',
                 '2017-12', '2018- 1', '2018- 2', '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8',
                 '2018- 9', '2018-10', '2018-11']
        ieee_arr = [1.77, 1.79, 2.22, 2.49, 2.06, 2.03, 1.84, 2.13, 2.54, 2.02, 1.85, 2.09, 3.25, 2.37, 2.4, 2.32, 2.48,
                    1.72, 1.95, 1.68, 2.52, 2.54, 2.34, 2.34, 2.85, 2.74, 3.26, 2.02, 2.33, 2.33, 3.05, 2.53, 2.48, 2.4,
                    2.26, 2.2, 2.52, 2.1, 2.14, 2.09, 2.72, 2.26, 2.31, 2.39, 2.92, 2.82, 1.68, 2.48, 1.91, 1.75, 2.5,
                    1.76, 2.51, 3.18, 2.29, 2.15, 2.25, 2.11, 2.79, 2.4, 1.79, 2.31, 2.66, 2.4, 2.09, 2.02, 1.9, 2.16,
                    2.68, 2.27, 1.92, 2.34, 2.49, 1.56, 1.74]
        fuzzy_arr = [4.53, 4.62, 5.54, 6.15, 5.23, 5.13, 4.33, 2.67, 2.22, 1.81, 1.68, 1.88, 2.8, 2.09, 2.12, 2.07,
                     2.17, 1.58, 1.77, 1.55, 2.21, 2.23, 2.07, 2.06, 2.46, 2.39, 2.78, 1.81, 2.07, 2.07, 2.61, 2.21,
                     2.18, 2.11, 2.01, 1.97, 2.2, 1.87, 1.91, 1.86, 2.37, 2.01, 2.06, 2.11, 2.53, 2.44, 1.55, 2.18,
                     1.74, 1.61, 2.2, 1.62, 2.2, 2.72, 2.03, 1.92, 1.99, 1.89, 2.42, 2.11, 1.64, 2.04, 2.32, 2.12, 1.88,
                     1.82, 1.73, 1.94, 2.33, 2.02, 1.74, 2.07, 2.19, 1.45, 1.59]
        carriel_arr = [2.35, 2.05, 2.21, 2.33, 1.86, 1.69, 1.44, 1.56, 1.73, 1.33, 1.18, 1.3, 1.91, 1.37, 1.35, 1.29,
                       1.35, 0.94, 1.05, 0.91, 1.34, 1.35, 1.25, 1.24, 1.5, 1.45, 1.7, 1.08, 1.24, 1.24, 1.6, 1.34,
                       1.32, 1.28, 1.21, 1.18, 1.33, 1.13, 1.15, 1.12, 1.44, 1.21, 1.24, 1.27, 1.54, 1.49, 0.92, 1.31,
                       1.03, 0.96, 1.33, 0.96, 1.33, 1.66, 1.22, 1.15, 1.2, 1.13, 1.47, 1.27, 0.97, 1.23, 1.41, 1.28,
                       1.12, 1.09, 1.03, 1.16, 1.41, 1.22, 1.04, 1.25, 1.32, 0.86, 0.94]

        ieee_sum_pu = 5198.495271
        fuzzy_sum_pu = 5285.185048
        carriel_sum_pu = 3005.123577
        agua_mean = 0.187678
        oxigenio_mean = 12100.506608
        temp_mean = 104.802904
        start_excel_day = datetime.date(2012, 9, 13)
        end_excel_day = datetime.date(2018, 11, 30)
    elif transformer.path_name == 'ATI01_TR-03':

        x_arr = ['2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11', '2014-12', '2015- 1', '2015- 2',
                 '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8', '2015- 9', '2015-10', '2015-11',
                 '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5', '2016- 6', '2016- 7', '2016- 8',
                 '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2', '2017- 3', '2017- 4', '2017- 5',
                 '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11', '2017-12', '2018- 1', '2018- 2',
                 '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8', '2018- 9', '2018-10', '2018-11']
        ieee_arr = [2.58, 2.72, 1.91, 2.14, 1.81, 2.65, 2.58, 2.25, 2.45, 2.28, 2.21, 2.01, 1.84, 2.43, 2.1, 1.92, 1.95,
                    2.32, 2.64, 2.08, 2.0, 2.78, 2.17, 1.54, 2.11, 2.79, 1.83, 2.62, 2.19, 2.13, 2.69, 2.55, 2.11, 2.01,
                    1.73, 2.57, 1.74, 2.08, 2.35, 2.4, 2.1, 2.35, 2.67, 2.29, 2.22, 2.6, 3.4, 1.48, 2.14, 2.2, 1.84,
                    1.65, 2.22, 2.28]
        fuzzy_arr = [6.33, 6.62, 4.86, 5.38, 4.65, 6.5, 6.35, 5.65, 6.06, 5.65, 5.51, 5.1, 4.74, 6.03, 5.3, 4.89, 4.95,
                     5.74, 6.47, 5.27, 5.06, 6.76, 5.45, 4.07, 5.32, 6.8, 4.68, 6.45, 5.5, 5.37, 6.58, 6.3, 5.33, 5.09,
                     4.48, 6.33, 4.5, 5.29, 5.85, 5.95, 5.31, 5.84, 6.51, 5.69, 5.53, 6.39, 8.13, 3.91, 5.37, 5.52,
                     4.74, 4.31, 5.56, 5.69]
        carriel_arr = [2.89, 2.81, 1.92, 2.05, 1.56, 2.09, 1.93, 1.7, 1.83, 1.7, 1.66, 1.52, 1.41, 1.82, 1.59, 1.46,
                       1.48, 1.74, 1.97, 1.58, 1.51, 2.06, 1.64, 1.2, 1.59, 2.07, 1.39, 1.96, 1.65, 1.61, 2.0, 1.9, 1.6,
                       1.52, 1.33, 1.91, 1.33, 1.58, 1.76, 1.8, 1.59, 1.76, 1.98, 1.72, 1.66, 1.93, 2.49, 1.15, 1.61,
                       1.66, 1.4, 1.28, 1.67, 1.71]

        ieee_sum_pu = 3646.490431
        fuzzy_sum_pu = 9116.109137
        carriel_sum_pu = 2820.717895
        agua_mean = 0.169051
        oxigenio_mean = 5650.183711
        temp_mean = 105.021719
        start_excel_day = datetime.date(2014, 6, 12)
        end_excel_day = datetime.date(2018, 11, 30)

    elif transformer.path_name == 'BJP01_TR-01':

        x_arr = ['2008-12', '2009- 1', '2009- 2', '2009- 3', '2009- 4', '2009- 5', '2009- 6', '2009- 7', '2009- 8',
                 '2009- 9', '2009-10', '2009-11', '2009-12', '2010- 1', '2010- 2', '2010- 3', '2010- 4', '2010- 5',
                 '2010- 6', '2010- 7', '2010- 8', '2010- 9', '2010-10', '2010-11', '2010-12', '2011- 1', '2011- 2',
                 '2011- 3', '2011- 4', '2011- 5', '2011- 6', '2011- 7', '2011- 8', '2011- 9', '2011-10', '2011-11',
                 '2011-12', '2012- 1', '2012- 2', '2012- 3', '2012- 4', '2012- 5', '2012- 6', '2012- 7', '2012- 8',
                 '2012- 9', '2012-10', '2012-11', '2012-12', '2013- 1', '2013- 2', '2013- 3', '2013- 4', '2013- 5',
                 '2013- 6', '2013- 7', '2013- 8', '2013- 9', '2013-10', '2013-11', '2013-12', '2014- 1', '2014- 2',
                 '2014- 3', '2014- 4', '2014- 5', '2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11',
                 '2014-12', '2015- 1', '2015- 2', '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8',
                 '2015- 9', '2015-10', '2015-11', '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5',
                 '2016- 6', '2016- 7', '2016- 8', '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2',
                 '2017- 3', '2017- 4', '2017- 5', '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11',
                 '2017-12', '2018- 1', '2018- 2', '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8',
                 '2018- 9', '2018-10', '2018-11']
        ieee_arr = [6.13, 6.13, 6.15, 6.12, 6.2, 6.06, 6.17, 6.11, 6.07, 6.12, 6.16, 6.06, 6.13, 6.06, 6.19, 6.24, 6.2,
                    6.14, 6.14, 6.08, 6.18, 6.15, 6.1, 6.06, 6.18, 6.18, 6.13, 6.07, 6.16, 6.16, 6.17, 6.15, 6.15, 6.16,
                    6.23, 6.23, 6.1, 6.06, 6.06, 6.17, 6.3, 6.09, 6.06, 6.15, 6.1, 6.08, 6.08, 6.07, 6.15, 6.14, 6.14,
                    6.19, 6.03, 6.1, 6.17, 6.09, 6.17, 6.2, 6.19, 6.13, 6.11, 6.09, 6.12, 6.13, 6.11, 6.15, 6.03, 6.12,
                    6.09, 6.29, 6.16, 6.16, 6.13, 6.14, 6.19, 6.08, 6.1, 6.07, 6.09, 6.17, 6.09, 6.03, 6.1, 6.22, 6.17,
                    6.05, 6.11, 6.02, 6.2, 6.06, 6.17, 6.1, 6.15, 6.17, 6.17, 6.18, 6.22, 6.09, 6.19, 6.19, 6.11, 6.07,
                    6.06, 6.15, 6.17, 6.14, 6.15, 6.24, 6.15, 6.09, 6.09, 6.09, 6.14, 6.05, 6.09, 6.17, 6.17, 6.1, 6.14,
                    6.06]
        fuzzy_arr = [1.76, 1.76, 1.78, 1.75, 1.78, 1.74, 1.77, 1.76, 1.74, 1.76, 1.77, 1.8, 1.77, 1.74, 1.78, 1.79,
                     1.78, 1.76, 1.76, 1.75, 1.76, 1.76, 1.76, 1.75, 1.77, 1.8, 1.76, 1.74, 1.76, 1.77, 1.79, 1.76,
                     1.76, 1.78, 1.79, 1.78, 1.76, 1.74, 1.75, 1.76, 1.8, 1.78, 1.74, 1.77, 1.76, 1.74, 1.75, 1.76,
                     1.78, 1.77, 1.77, 1.77, 1.73, 1.79, 1.77, 1.76, 1.77, 1.78, 1.77, 1.76, 1.76, 1.76, 1.76, 1.76,
                     1.75, 1.77, 1.73, 1.76, 1.76, 1.81, 1.77, 1.76, 1.76, 1.77, 1.81, 1.76, 1.76, 1.74, 1.77, 1.77,
                     1.76, 1.74, 1.75, 1.78, 1.77, 1.75, 1.77, 1.75, 1.78, 1.74, 1.77, 1.78, 1.76, 1.78, 1.76, 1.83,
                     1.78, 1.75, 1.78, 1.79, 1.76, 1.76, 1.74, 1.77, 1.77, 1.77, 1.76, 1.78, 1.76, 1.75, 1.75, 1.75,
                     1.76, 1.74, 1.75, 1.77, 1.78, 1.75, 1.77, 1.74]
        carriel_arr = [1.46, 1.42, 1.36, 1.27, 1.25, 1.19, 1.2, 1.19, 1.18, 1.19, 1.2, 1.24, 1.2, 1.18, 1.2, 1.21, 1.21,
                       1.19, 1.19, 1.18, 1.19, 1.19, 1.19, 1.18, 1.2, 1.23, 1.18, 1.17, 1.19, 1.2, 1.22, 1.18, 1.19,
                       1.2, 1.21, 1.21, 1.19, 1.17, 1.19, 1.19, 1.22, 1.22, 1.17, 1.19, 1.19, 1.17, 1.19, 1.2, 1.21,
                       1.2, 1.2, 1.2, 1.17, 1.23, 1.2, 1.19, 1.2, 1.21, 1.19, 1.19, 1.19, 1.19, 1.19, 1.19, 1.18, 1.2,
                       1.17, 1.19, 1.19, 1.23, 1.2, 1.19, 1.18, 1.2, 1.24, 1.19, 1.19, 1.17, 1.21, 1.2, 1.19, 1.17,
                       1.19, 1.2, 1.19, 1.18, 1.21, 1.19, 1.21, 1.17, 1.19, 1.21, 1.19, 1.21, 1.19, 1.26, 1.21, 1.18,
                       1.2, 1.21, 1.19, 1.2, 1.18, 1.19, 1.2, 1.2, 1.19, 1.2, 1.19, 1.18, 1.18, 1.18, 1.18, 1.17, 1.18,
                       1.2, 1.21, 1.18, 1.2, 1.18]

        ieee_sum_pu = 22391.101796
        fuzzy_sum_pu = 6443.563436
        carriel_sum_pu = 4386.761912
        agua_mean = 0.787998
        oxigenio_mean = 13240.703724
        temp_mean = 93.277159
        start_excel_day = datetime.date(2008, 12, 1)
        end_excel_day = datetime.date(2018, 11, 30)

    elif transformer.path_name == 'BJP01_TR-02':

        x_arr = ['2008-12', '2009- 1', '2009- 2', '2009- 3', '2009- 4', '2009- 5', '2009- 6', '2009- 7', '2009- 8',
                 '2009- 9', '2009-10', '2009-11', '2009-12', '2010- 1', '2010- 2', '2010- 3', '2010- 4', '2010- 5',
                 '2010- 6', '2010- 7', '2010- 8', '2010- 9', '2010-10', '2010-11', '2010-12', '2011- 1', '2011- 2',
                 '2011- 3', '2011- 4', '2011- 5', '2011- 6', '2011- 7', '2011- 8', '2011- 9', '2011-10', '2011-11',
                 '2011-12', '2012- 1', '2012- 2', '2012- 3', '2012- 4', '2012- 5', '2012- 6', '2012- 7', '2012- 8',
                 '2012- 9', '2012-10', '2012-11', '2012-12', '2013- 1', '2013- 2', '2013- 3', '2013- 4', '2013- 5',
                 '2013- 6', '2013- 7', '2013- 8', '2013- 9', '2013-10', '2013-11', '2013-12', '2014- 1', '2014- 2',
                 '2014- 3', '2014- 4', '2014- 5', '2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11',
                 '2014-12', '2015- 1', '2015- 2', '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8',
                 '2015- 9', '2015-10', '2015-11', '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5',
                 '2016- 6', '2016- 7', '2016- 8', '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2',
                 '2017- 3', '2017- 4', '2017- 5', '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11',
                 '2017-12', '2018- 1', '2018- 2', '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8',
                 '2018- 9', '2018-10', '2018-11']
        ieee_arr = [5.44, 5.51, 5.55, 5.62, 5.6, 5.69, 5.5, 5.53, 5.62, 5.63, 5.52, 5.57, 5.57, 5.47, 5.49, 5.54, 5.5,
                    5.63, 5.55, 5.52, 5.61, 5.54, 5.56, 5.5, 5.53, 5.55, 5.66, 5.65, 5.51, 5.72, 5.7, 5.57, 5.6, 5.57,
                    5.45, 5.58, 5.63, 5.59, 5.66, 5.61, 5.55, 5.55, 5.71, 5.47, 5.62, 5.61, 5.54, 5.53, 5.62, 5.7, 5.64,
                    5.59, 5.67, 5.65, 5.69, 5.62, 5.58, 5.59, 5.51, 5.54, 5.52, 5.54, 5.56, 5.49, 5.58, 5.52, 5.72,
                    5.66, 5.57, 5.6, 5.55, 5.57, 5.66, 5.53, 5.57, 5.62, 5.54, 5.6, 5.54, 5.53, 5.56, 5.62, 5.61, 5.45,
                    5.52, 5.54, 5.52, 5.65, 5.61, 5.58, 5.59, 5.48, 5.65, 5.59, 5.54, 5.46, 5.59, 5.52, 5.57, 5.55,
                    5.57, 5.59, 5.59, 5.52, 5.55, 5.56, 5.63, 5.43, 5.7, 5.78, 5.49, 5.48, 5.5, 5.54, 5.64, 5.55, 5.61,
                    5.55, 5.57, 5.59]
        fuzzy_arr = [1.97, 1.74, 1.77, 1.79, 1.76, 1.78, 1.75, 1.73, 1.76, 1.78, 1.74, 1.81, 1.75, 1.72, 1.76, 1.75,
                     1.74, 1.77, 1.75, 1.76, 1.76, 1.78, 1.75, 1.74, 1.74, 1.75, 1.78, 1.78, 1.75, 1.79, 1.8, 1.77,
                     1.76, 1.76, 1.73, 1.76, 1.77, 1.76, 1.8, 1.78, 1.77, 1.75, 1.82, 1.73, 1.76, 1.77, 1.76, 1.75,
                     1.76, 1.79, 1.77, 1.76, 1.79, 1.78, 1.8, 1.77, 1.76, 1.76, 1.75, 1.75, 1.74, 1.74, 1.74, 1.75,
                     1.79, 1.75, 1.8, 1.78, 1.76, 1.77, 1.75, 1.76, 1.77, 1.75, 1.75, 1.79, 1.76, 1.76, 1.76, 1.74,
                     1.76, 1.77, 1.75, 1.72, 1.75, 1.75, 1.74, 1.77, 1.77, 1.74, 1.78, 1.75, 1.79, 1.76, 1.75, 1.74,
                     1.75, 1.75, 1.75, 1.76, 1.77, 1.76, 1.76, 1.74, 1.75, 1.79, 1.78, 1.71, 1.79, 1.8, 1.73, 1.73,
                     1.74, 1.75, 1.77, 1.75, 1.77, 1.75, 1.76, 1.76]
        carriel_arr = [1.64, 1.59, 1.57, 1.51, 1.44, 1.45, 1.37, 1.34, 1.36, 1.38, 1.35, 1.43, 1.36, 1.33, 1.37, 1.36,
                       1.35, 1.38, 1.35, 1.37, 1.37, 1.39, 1.36, 1.35, 1.34, 1.36, 1.38, 1.39, 1.36, 1.39, 1.41, 1.38,
                       1.37, 1.37, 1.33, 1.36, 1.37, 1.36, 1.4, 1.39, 1.38, 1.35, 1.43, 1.34, 1.37, 1.38, 1.37, 1.35,
                       1.36, 1.4, 1.38, 1.38, 1.4, 1.38, 1.4, 1.38, 1.36, 1.37, 1.37, 1.35, 1.35, 1.36, 1.34, 1.36, 1.4,
                       1.35, 1.4, 1.39, 1.37, 1.38, 1.36, 1.36, 1.38, 1.36, 1.35, 1.4, 1.37, 1.37, 1.37, 1.34, 1.37,
                       1.37, 1.36, 1.33, 1.36, 1.36, 1.35, 1.37, 1.38, 1.35, 1.38, 1.36, 1.39, 1.37, 1.36, 1.36, 1.36,
                       1.36, 1.35, 1.37, 1.37, 1.37, 1.36, 1.35, 1.36, 1.4, 1.39, 1.32, 1.39, 1.4, 1.34, 1.34, 1.35,
                       1.36, 1.37, 1.35, 1.38, 1.36, 1.37, 1.36]

        ieee_sum_pu = 20358.963919
        fuzzy_sum_pu = 6436.401890
        carriel_sum_pu = 5024.135434
        agua_mean = 0.688072
        oxigenio_mean = 10936.582694
        temp_mean = 94.275889
        start_excel_day = datetime.date(2008, 12, 1)
        end_excel_day = datetime.date(2018, 11, 30)

    elif transformer.path_name == 'CAJ01_TR-01':

        x_arr = ['2008-12', '2009- 1', '2009- 2', '2009- 3', '2009- 4', '2009- 5', '2009- 6', '2009- 7', '2009- 8',
                 '2009- 9', '2009-10', '2009-11', '2009-12', '2010- 1', '2010- 2', '2010- 3', '2010- 4', '2010- 5',
                 '2010- 6', '2010- 7', '2010- 8', '2010- 9', '2010-10', '2010-11', '2010-12', '2011- 1', '2011- 2',
                 '2011- 3', '2011- 4', '2011- 5', '2011- 6', '2011- 7', '2011- 8', '2011- 9', '2011-10', '2011-11',
                 '2011-12', '2012- 1', '2012- 2', '2012- 3', '2012- 4', '2012- 5', '2012- 6', '2012- 7', '2012- 8',
                 '2012- 9', '2012-10', '2012-11', '2012-12', '2013- 1', '2013- 2', '2013- 3', '2013- 4', '2013- 5',
                 '2013- 6', '2013- 7', '2013- 8', '2013- 9', '2013-10', '2013-11', '2013-12', '2014- 1', '2014- 2',
                 '2014- 3', '2014- 4', '2014- 5', '2014- 6', '2014- 7', '2014- 8', '2014- 9', '2014-10', '2014-11',
                 '2014-12', '2015- 1', '2015- 2', '2015- 3', '2015- 4', '2015- 5', '2015- 6', '2015- 7', '2015- 8',
                 '2015- 9', '2015-10', '2015-11', '2015-12', '2016- 1', '2016- 2', '2016- 3', '2016- 4', '2016- 5',
                 '2016- 6', '2016- 7', '2016- 8', '2016- 9', '2016-10', '2016-11', '2016-12', '2017- 1', '2017- 2',
                 '2017- 3', '2017- 4', '2017- 5', '2017- 6', '2017- 7', '2017- 8', '2017- 9', '2017-10', '2017-11',
                 '2017-12', '2018- 1', '2018- 2', '2018- 3', '2018- 4', '2018- 5', '2018- 6', '2018- 7', '2018- 8',
                 '2018- 9', '2018-10', '2018-11']
        ieee_arr = [6.35, 6.22, 6.17, 6.13, 6.23, 6.21, 6.21, 6.24, 6.16, 6.31, 6.17, 6.25, 6.1, 6.3, 6.14, 6.18, 6.17,
                    6.18, 6.18, 6.15, 6.22, 6.24, 6.22, 6.19, 6.25, 6.33, 6.25, 6.32, 6.19, 6.15, 6.2, 6.31, 6.14, 6.16,
                    6.13, 6.17, 6.3, 6.21, 6.26, 6.35, 6.22, 6.37, 6.2, 6.17, 6.35, 6.19, 6.21, 6.31, 6.21, 6.19, 6.33,
                    6.15, 6.28, 6.36, 6.24, 6.22, 6.29, 6.42, 6.11, 6.24, 6.37, 6.16, 6.21, 6.18, 6.18, 6.24, 6.36,
                    6.16, 6.22, 6.4, 6.19, 6.22, 6.11, 6.13, 6.26, 6.18, 6.39, 6.21, 6.13, 6.2, 6.22, 6.31, 6.13, 6.25,
                    6.16, 6.21, 6.25, 6.26, 6.16, 6.33, 6.29, 6.16, 6.27, 6.21, 6.3, 6.14, 6.36, 6.28, 6.34, 6.1, 6.19,
                    6.37, 6.31, 6.28, 6.12, 6.23, 6.33, 6.17, 6.12, 6.24, 6.26, 6.25, 6.32, 6.27, 6.34, 6.28, 6.27,
                    6.09, 6.21, 6.23]
        fuzzy_arr = [1.79, 1.76, 1.76, 1.75, 1.05, 0.97, 1.01, 1.0, 1.03, 1.01, 0.98, 1.01, 1.03, 1.52, 1.05, 0.99,
                     1.01, 1.0, 1.05, 0.99, 0.96, 1.03, 1.0, 1.0, 0.99, 0.98, 1.02, 1.1, 1.11, 1.26, 1.05, 1.01, 1.01,
                     0.96, 1.16, 0.97, 1.0, 1.12, 1.0, 1.07, 1.01, 1.02, 1.0, 0.98, 1.05, 1.07, 1.42, 1.02, 0.98, 1.1,
                     1.11, 1.0, 1.0, 1.16, 1.22, 1.12, 1.24, 1.03, 0.98, 0.99, 1.0, 1.02, 1.0, 0.97, 1.15, 1.01, 1.05,
                     0.96, 1.01, 1.25, 0.97, 1.05, 0.97, 0.99, 1.08, 1.18, 0.99, 0.99, 1.01, 1.01, 0.98, 1.17, 1.02,
                     0.98, 0.99, 1.04, 1.02, 0.98, 1.12, 1.01, 1.01, 0.99, 1.07, 0.98, 1.0, 0.97, 1.01, 1.04, 1.07,
                     0.99, 1.27, 1.15, 1.55, 1.0, 0.99, 1.09, 1.01, 0.96, 1.01, 1.03, 1.05, 1.01, 1.08, 1.0, 1.04, 1.04,
                     0.98, 1.0, 1.11, 1.01]
        carriel_arr = [0.96, 0.91, 0.87, 0.86, 0.85, 0.84, 0.85, 0.85, 0.84, 0.85, 0.85, 0.85, 0.84, 0.86, 0.84, 0.86,
                       0.85, 0.85, 0.85, 0.85, 0.85, 0.85, 0.85, 0.84, 0.85, 0.87, 0.85, 0.88, 0.85, 0.84, 0.86, 0.86,
                       0.85, 0.85, 0.83, 0.84, 0.85, 0.85, 0.86, 0.88, 0.85, 0.87, 0.85, 0.84, 0.87, 0.84, 0.86, 0.86,
                       0.85, 0.84, 0.87, 0.84, 0.86, 0.88, 0.85, 0.85, 0.86, 0.88, 0.85, 0.85, 0.87, 0.84, 0.85, 0.85,
                       0.85, 0.86, 0.87, 0.85, 0.85, 0.87, 0.85, 0.85, 0.83, 0.84, 0.85, 0.84, 0.86, 0.85, 0.84, 0.85,
                       0.85, 0.89, 0.83, 0.85, 0.84, 0.84, 0.85, 0.86, 0.84, 0.88, 0.85, 0.84, 0.86, 0.85, 0.86, 0.84,
                       0.87, 0.85, 0.86, 0.83, 0.84, 0.87, 0.86, 0.86, 0.83, 0.85, 0.86, 0.84, 0.84, 0.85, 0.85, 0.85,
                       0.86, 0.85, 0.86, 0.86, 0.85, 0.83, 0.85, 0.85]

        ieee_sum_pu = 22756.812212
        fuzzy_sum_pu = 3912.105502
        carriel_sum_pu = 3118.424699
        agua_mean = 1.087588
        oxigenio_mean = 14104.956188
        temp_mean = 93.274293
        start_excel_day = datetime.date(2008, 12, 1)
        end_excel_day = datetime.date(2018, 11, 30)

    # Life time
    install_date = transformer.install_date
    start_excel_day = datetime.date(start_excel_day.year, start_excel_day.month, start_excel_day.day)
    end_excel_day = datetime.date(end_excel_day.year, end_excel_day.month, end_excel_day.day)
    excel_days = (end_excel_day - start_excel_day).days
    if install_date < start_excel_day:
        before_days = (start_excel_day - install_date).days
    else:
        before_days = 0

    ieee_factor = (ieee_sum_pu / excel_days)
    fuzzy_factor = (fuzzy_sum_pu / excel_days)
    carriel_factor = (carriel_sum_pu / excel_days)

    real_life_days = excel_days
    ieee_life_days = int (excel_days/ieee_factor)
    fuzzy_life_days = int(excel_days/fuzzy_factor)
    carriel_life_days = int(excel_days/carriel_factor)

    before_years = round(before_days/365, 1)
    real_life_years = round(real_life_days/365, 1)
    ieee_life_years = round(ieee_life_days/365, 1)
    fuzzy_life_years = round(fuzzy_life_days/365, 1)
    carriel_life_years = round(carriel_life_days/365, 1)

    real_life = "{} + {} = {} anos".format(before_years, real_life_years, round(before_years+real_life_years, 1) )
    ieee_life = "{} + {} = {} anos".format(before_years, ieee_life_years,  round(before_years+ieee_life_years, 1))
    fuzzy_life = "{} + {} = {} anos".format(before_years, fuzzy_life_years,  round(before_years+fuzzy_life_years, 1))
    carriel_life = "{} + {} = {} anos".format(before_years, carriel_life_years, round(before_years+carriel_life_years, 1))

    agua, oxigenio = dga_classification(agua_mean, oxigenio_mean)
    expected_life = 40

    life_days = {'real': real_life,
                 'ieee': ieee_life,
                 'fuzzy': fuzzy_life,
                 'carriel': carriel_life,
                 'ieee_remaining': "{:.1f} anos".format(expected_life-ieee_life_years-before_years),
                 'fuzzy_remaining': "{:.1f} anos".format(expected_life-fuzzy_life_years-before_years),
                 'carriel_remaining': "{:.1f} anos".format(expected_life-carriel_life_years-before_years),
                 'agua':agua ,
                 'oxigenio':oxigenio,
                 'temperatura':round(temp_mean,1)}

    # x_arr = ["January", "February", "March", "April", "May", "June", "July"]
    # ieee_arr = [0, 10, 5, 2, 20, 30, 45]
    # carriel_arr = [1, 11, 6, 3, 21, 31, 46]
    # fuzzy_arr = [2, 12, 7, 4, 22, 32, 47]

    data = {'x_values': x_arr,
            'ieee_values':  ieee_arr,
            'fuzzy_values': fuzzy_arr,
            'carriel_values': carriel_arr
            }
    return (life_days, json.dumps(data))


def dga_classification(h2o, o2):
    h2o = round(h2o,2)
    o2 = int(o2)
    # O2
    if o2<6000:
        str_o2 = "{} ppm (baixo)".format(o2)
    elif o2<15000:
        str_o2 = "{} ppm (médio)".format(o2)
    else:
        str_o2 = "{} ppm (alto)".format(o2)

    #H2O
    if h2o < 0.5:
        str_h2o = "{}% (baixo)".format(h2o)
    elif h2o < 1.5:
        str_h2o = "{}% (normal)".format(h2o)
    elif h2o < 2.3:
        str_h2o = "{}% (alto)".format(h2o)
    else:
        str_h2o = "{}% (muito alto)".format(h2o)

    return (str_h2o, str_o2)



